<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.csot.gm.materialManage.dao.extension.document.FileMapper" >
  <resultMap id="ResultMap" type="com.csot.gm.materialManage.model.extension.document.File" >
    <id column="ID" property="id" />
    <result column="FILE_NAME" property="fileName" jdbcType="VARCHAR"/>
    <result column="UPLOADER" property="uploader" jdbcType="VARCHAR"/>
    <result column="UPLOAD_TIME" property="uploadTime" jdbcType="TIMESTAMP"/>
    <result column="FILE_TYPE" property="fileType" jdbcType="VARCHAR"/>
    <result column="REMARK" property="remark" jdbcType="VARCHAR" />
  </resultMap>
  
  <insert id="addFileToDb" parameterType="com.csot.gm.materialManage.model.extension.document.File" >
    insert into T_GM_DOCUMENT 
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id !=null and id !=''">
        ID,
      </if>
      <if test="fileName !=null and fileName !=''">
        FILE_NAME,
      </if>
      <if test="uploader !=null and uploader !=''">
        UPLOADER,
      </if>
      <if test="uploadTime !=null and uploadTime !=''">
        UPLOAD_TIME,
      </if>
      <if test="fileType !=null and fileType !=''">
        FILE_TYPE,
      </if>
      <if test="remark !=null and remark !=''">
        REMARK,
      </if>
    </trim>
    VALUES
    <trim  prefix="(" suffix=")" suffixOverrides=",">
      <if test="id !=null and id !=''">
        #{id},
      </if>
      <if test="fileName !=null and fileName !=''">
        #{fileName},
      </if>
      <if test="uploader !=null and uploader !=''">
        #{uploader},
      </if>
      <if test="uploadTime !=null and uploadTime !=''">
        #{uploadTime},
      </if>
      <if test="fileType !=null and fileType !=''">
        #{fileType},
      </if>
      <if test="remark !=null and remark !=''">
        #{remark},
      </if>
    </trim>
  </insert>
  
  <select id="getAllFile" resultMap="ResultMap">
    select t.* from T_GM_DOCUMENT t order by t.upload_time desc
  </select>
  
  <select id="getFileById" parameterType="java.lang.String" resultMap="ResultMap">
    select t.* from T_GM_DOCUMENT t where t.id = #{id}
  </select>
  
  <select id="getFileByName" parameterType="java.lang.String" resultMap="ResultMap">
    select t.* from T_GM_DOCUMENT t where t.file_name like #{fileName}
  </select>
 
 <delete id="deleteFileById" parameterType="java.lang.String" >
   delete from T_GM_DOCUMENT where id = #{id}
 </delete>
 
 <select id="countRecordByFileName"  parameterType="java.lang.String" resultType="java.lang.Integer">
   select count(1) from T_GM_DOCUMENT t where  t.file_name = #{fileName}
 </select>
</mapper>