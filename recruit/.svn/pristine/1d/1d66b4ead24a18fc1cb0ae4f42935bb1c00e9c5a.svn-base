function search() {
    var key = mini.get("key").getValue();
    datagrid.load({
      searchKey : key
    });
  }

function bookInterview() {
  var grid = mini.get("datagrid1");
  var rows = grid.getSelecteds();
  if (rows.length > 0) {
      var id = rows[0].id;
      window.open(basePath + "/interviewBookController/addInterviewBook?id=" + id);
   
  }else{
    alert("请先选中候选人！");
  }
}

function outbookInterview(){

  var grid = mini.get("datagrid1");
  var rows = grid.getSelecteds();
  if (rows.length > 0) {
    var ids="";
    var positionIds = "" ;
    for(var i=0;i<rows.length;i++){
      ids+=rows[i].id;
      positionIds+=rows[i].positionid;
      if(i!=rows.length-1){
        ids+=",";
        positionIds+=",";
      }
    }
    
    mini.prompt("请输入原因：", "请输入",
        function (action, value) {
            if (action == "ok") {
              outAjaxInterviewBook(ids,positionIds,value);
            } else {
                mini.alert("取消");
            }
        },
        true
    );
   
  }else{
    alert("请先选中候选人！");
  }

}

function outAjaxInterviewBook(ids,positionIds,reason){
  mini.alert(reason);
  $.ajax({
    url : basePath + "/interviewBookController/outInterviewBook?ids=" + ids +"&positionIds=" + positionIds + "&reason=" + reason,
    type : "post",
    success : function(data) {
     var dataJson = eval('(' + data + ')');
        mini.alert(dataJson.msg);
    }
  });
  
}

  //导出校招通讯录模板
  function onExport() {

    var realName = mini.get("key").getValue();
    realName = encodeURI(encodeURI(realName)); // url传参非asc码必须先转码再传，否则会出现乱码
    window.location.href = "/recruit/campusAddressbookController/exportCampusTemplete?realName="
        + realName;
  }