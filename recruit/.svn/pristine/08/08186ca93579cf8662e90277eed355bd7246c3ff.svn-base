<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="t" uri="/recruit-tags"%>
<%@include file="/webpage/common.jsp"%>
<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="${webRoot }/resources/css/system/baseUserList.css" />
<base href="${basePath}">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<title>校招通讯录</title>
<style type="text/css">
</style>
</head>
<body onload="removeLoad();">
  <jsp:include page="/webpage/header.jsp"></jsp:include>
  <div class="co">
    <div class="co-left">
      <jsp:include page="/webpage/left-bar.jsp"></jsp:include>
    </div>
    <div class="co-right">
      <div class="position-path co-right-center">
        <span class="path-title">您的位置 :</span><a class="path-item a-decoration"
          href="${webRoot}/loginController/main">我的首页</a><em class="path-icon">&gt;&gt;</em><span
          class="path-leaf">招聘支持</span><em class="path-icon">&gt;&gt;</em><span class="path-leaf">校招通讯录</span>
      </div>
      <div class="co-right-main co-right-center">
        <div class="con-title">校招通讯录管理</div>
        <div class="account-content">
          <div class="account-search">
            <table class="tblQuery2">
              <tbody>
                <tr>
                  <td><input emptyText="请输入姓名" style="width: 150px" class="mini-textbox"
                    id="key"></td>
                  <td>&nbsp;&nbsp; <input type="submit" value="查询" tabindex="5"
                    class="search_btn" id="btnRefresh" onclick="search()" name="btnRefresh">
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="blue radius">
            <div class="table-operate">
              <input type="button" class="button radius btn" id="uploadButton" value="导入"
                onclick="onImport()" /> <input type="button" class="button radius btn" id="create"
                value="新增" onclick="create()" /> <input type="button" class="button radius btn"
                id="modify" value="修改" onclick="modify()" /> <input type="button"
                class="button radius btn" id="remove" value="删除" onclick="remove()" /> <input
                type="button" class="button radius btn" id="create" value="导出" onclick="onExport()" />
            </div>
            <div id="datagrid1" class="mini-datagrid"
              url="/recruit/campusAddressbookController/datagrid" idField="id"
              sizeList="[1,20,50,100]" pageSize="20" allowResize="false" style="height: 350px;">
              <div property="columns">
                <div type="checkcolumn" width="30"></div>
                <!-- <div type="indexcolumn" width="30">序号</div>  -->
                <div name="workNo" field="workNo" width="80" allowSort="true">工号</div>
                <div name="realname" field="realname" width="80" allowSort="true">姓名</div>
                <div name="siteName" field="siteName" width="80" allowSort="true">站点</div>
                <div name="siteId" field="siteId" width="80" allowSort="true">站点ID</div>
                <div name="campusRole" field="campusRole" width="80" allowSort="true">校招角色</div>
                <div name="phoneno" field="phoneno" width="80" allowSort="false">联系电话</div>
                <div name="email" field="email" width="80" allowSort="false">邮箱</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <jsp:include page="/webpage/footer.jsp"></jsp:include>
</body>
<script>
  mini.parse();
  var datagrid = mini.get("datagrid1");
  datagrid.load();

  function search() {
    var key = mini.get("key").getValue();
    datagrid.load({
      searchKey : key
    });
  }

  function create() {
    OpenDialog("/recruit/campusAddressbookController/create/", "新建人员信息", datagrid, 380, 350);
  }

  function modify() {
    var row = datagrid.getSelected();
    if (row) {
      OpenDialog("/recruit/campusAddressbookController/modify/" + row.id, "编辑人员信息", datagrid, 380,
          350);
    } else {
      ShowWarnTip("请选择一条记录");
    }
  }

  function remove() {
    var data = datagrid.getSelected();
    if (data) {
      var id = data.id;
      mini.confirm("确定删除记录？<br>", "删除", function(action) {
        if (action == "ok") {
          SaveData("/recruit/campusAddressbookController/remove/" + id, "", function(e) {
            ShowActionTip(e);
            datagrid.reload();
          });
        }
      });
    } else {
      ShowWarnTip("请选择一条记录");
    }
  }

  //导入校招通讯录模板
  function onImport() {
    mini.open({
      url : "/recruit/campusAddressbookController/importAddressbook",
      title : "导入校招通讯录模板",
      width : 400,
      height : 100,
      allowResize : false
    });
  }

  //导出校招通讯录模板
  function onExport() {

    var realName = mini.get("key").getValue();
    realName = encodeURI(encodeURI(realName)); // url传参非asc码必须先转码再传，否则会出现乱码
    window.location.href = "/recruit/campusAddressbookController/exportCampusTemplete?realName="
        + realName;
  }
</script>
</html>